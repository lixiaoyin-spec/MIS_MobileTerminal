# 后端端口说明（v1）

> 统一说明：除“注册 / 登录”外，其余需要登录的接口都必须在 **Header** 中携带  
> `Authorization: Bearer <登录返回的 token>`。
>
> 特别注意这里的token每次更新登录都会不同，比如重启后端后用户重新登录得到的token都是不一样的，在端口测试时需要注意
>
> 返回结构统一为：`{ "code": 200, "msg": "xxx", "data": ... }`（部分接口 `data` 为 `null`）。

## 用户相关

### 1. 注册
- **方法**：POST  
- **URL**：`/api/user/register`  
- **Header**：`Content-Type: application/json`  
- **请求体（JSON）**：
  ```json
  {
    "username": "alice",
    "password": "123456",
    "nickname": "Alice",
    "major": "计算机科学",
    "grade": 2023,
    "interestTags": "1,3"        // 1-5 的数字，逗号分隔
  }
  ```
- **成功返回**：`{ "code": 200, "msg": "注册成功" }`

### 2. 登录
- **方法**：POST  
- **URL**：`/api/user/login`  
- **Header**：`Content-Type: application/json`  
- **请求体（JSON）**：
  ```json
  {
    "username": "alice",
    "password": "123456"
  }
  ```
- **成功返回（data 为用户信息 + token）**：
  ```json
  {
    "code": 200,
    "msg": "登录成功",
    "data": {
      "id": 1,
      "username": "alice",
      "nickname": "Alice",
      "major": "计算机科学",
      "grade": 2023,
      "interestTags": "1,3",
      "role": "STUDENT",
      "token": "TOKEN_xxx"       // 之后请求放到 Authorization 里
    }
  }
  ```

### 3. 修改个人标签
- **方法**：POST  
- **URL**：`/api/user/tag`  
- **Headers**：
  - `Content-Type: application/json`
  - `Authorization: Bearer <登录返回的 token>`  
- **请求体（JSON，示例 TagVO）**：
  ```json
  {
    "token": "TOKEN_xxx",
    "interestTags": "1,4,5"
  }
  ```
- **成功返回**：`{ "code": 200, "msg": "标签修改成功" }`

## 帖子相关

### 4. 发帖
- **方法**：POST  
- **URL**：`/api/post/create`  
- **Headers**：
  - `Content-Type: application/json`
  - `Authorization: Bearer <登录返回的 token>`  
- **请求体（JSON，PostVO）**：
  ```json
  {
    "token": "TOKEN_xxx",
    "title": "标题",
    "content": "帖子内容"
  }
  ```
- **成功返回**：`{ "code": 200, "msg": "发帖成功", "data": null }`

### 5. 帖子列表
- **方法**：GET  
- **URL**：`/api/post/list`  
- **Header**：`Authorization: Bearer <登录返回的 token>`  
- **请求体**：无  
- **成功返回（data 为帖子列表）**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "data": [
      {
        "id": 1,
        "nickname": "Alice",
        "title": "标题",
        "content": "帖子内容",
        "createTime": "2025-11-26T12:00:00"
      }
    ]
  }
  ```

## 评论相关

### 6. 添加评论
- **方法**：POST  
- **URL**：`/api/comment/add`  
- **Headers**：
  - `Content-Type: application/json`
  - `Authorization: Bearer <登录返回的 token>`  
- **请求体（JSON，CommentVO）**：
  ```json
  {
    "postId": 1,
    "content": "评论内容",
    "token": "TOKEN_xxx"
  }
  ```
- **成功返回**：`{ "code": 200, "msg": "评论成功", "data": null }`

### 7. 获取帖子评论列表
- **方法**：GET  
- **URL**：`/api/comment/list`  
- **Headers**：`Authorization: Bearer <登录返回的 token>`  
- **Query 参数**：`postId=<帖子ID>`  
  - 完整示例：`/api/comment/list?postId=1`  
- **成功返回（data 为评论列表）**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "data": [
      {
        "id": 1,
        "postId": 1,
        "nickname": "Alice",
        "content": "评论内容",
        "createTime": "2025-11-26T12:00:00"
      }
    ]
  }
  ```

## 打卡相关

### 8. 新增打卡
- **方法**：POST  
- **URL**：`/api/clock/add`  
- **Headers**：
  - `Content-Type: application/json`
  - `Authorization: Bearer <登录返回的 token>`  
- **请求体（JSON，ClockVO）**：
  ```json
  {
    "content": "今天学习了 Spring Boot",
    "token": "TOKEN_xxx"
  }
  ```
- **成功返回**：`{ "code": 200, "msg": "打卡成功", "data": null }`

### 9. 打卡列表（当前用户）
- **方法**：GET  
- **URL**：`/api/clock/list`  
- **Headers**：`Authorization: Bearer <登录返回的 token>`  
- **Query 参数**：`token=TOKEN_xxx`  
  - 完整示例：`/api/clock/list?token=TOKEN_xxx`  
- **成功返回（data 为打卡记录列表）**：
  ```json
  {
    "code": 200,
    "msg": "查询成功",
    "data": [
      {
        "id": 1,
        "nickname": "Alice",
        "content": "今天学习了 Spring Boot",
        "clockDate": "2025-11-26",
        "createTime": "2025-11-26T12:00:00"
      }
    ]
  }
  ```

## 学伴推荐

### 10. 学伴推荐
- **方法**：GET  
- **URL**：`/api/partner/recommend`  
- **Headers**：`Authorization: Bearer <登录返回的 token>`  
- **Query 参数**：`token=TOKEN_xxx`  
  - 示例：`/api/partner/recommend?token=TOKEN_xxx`  
- **成功返回（data 为推荐学伴列表）**：
  ```json
  {
    "code": 200,
    "msg": "推荐成功",
    "data": [
      {
        "name": "Bob",
        "major": "软件工程",
        "tags": "1,3,5",
        "sameTagCount": 2
      }
    ]
  }
  ```

## 资源上传

### 11. 上传学习资源
- **方法**：POST  
- **URL**：`/api/resource/upload`  
- **Headers**：
  - `Content-Type: multipart/form-data`
  - `Authorization: Bearer <登录返回的 token>`  
- **表单字段（Form-Data）**：
  - `file`：文件（`MultipartFile`）  
  - `token`：`TOKEN_xxx`  
- **成功返回（data 为文件访问 URL）**：
  ```json
  {
    "code": 200,
    "msg": "上传成功",
    "data": "http://localhost:8081/upload/xxx.pdf"
  }
  ```